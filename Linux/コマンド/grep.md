# grep

## ファイルの中身検索

```bash
$ grep 検索文字 対象
```

```bash
# work ディレクトリ以下のファイルから、 hoge という文字列を探す
$ grep hoge work/*
```

### 検索結果に行番号を表示

- `-n` オプション

```bash
# .bashrc から、 PS1 という文字列を探す + 結果に行番号を表示
$ grep -n PS1 .bashrc
```

### 大文字小文字を区別せずにマッチさせる

- `-i` オプション

```bash
# work ディレクトリ以下のファイルから、hoge という文字列を大文字小文字区別なく探す
$ grep -i hoge work/*
```

### マッチしなかった行を探す

- `-v` オプション

   - ログファイルなどから、不要な行を除いて表示したいときなどに使う

```bash
$ .bashrc から、PS1 という文字列を含まない行を探す
$ grep -v PS1 .bashrc
```

### 拡張正規表現

`+` とか `?` のメタ文字を使いたい時は、 `-E` オプションを付ける

### メモ

#### 正規表現は基本シングルクォートで囲む

```bash
$ grep 't.st' example.txt
```

#### 空行にマッチさせる

- `^$`

```bash
$ hoge.txt から、空の行を除いて表示する
$ grep -v '^$' hoge.txt
```

#### grep には ls の結果を渡したりできる

```bash
# ls /etc/ の結果から、sys を含むファイルを探す
$ ls /etc/ | grep sys
```

### メタ文字

| 正規表現 | 意味 | 種類 |
| :---: | :---: | :---: |
| * | 直前の文字の、0回以上の繰り返し | 基本 |
| + | 直前の文字の、1回以上の繰り返し | 拡張 |
| ? | 直前の文字の、0回または1回の繰り返し | 拡張 |
| {m,n} | 直前の文字の、m回以上n回以下の繰り返し | 拡張 |
| {m} | 直前の文字の、ちょうどm回の繰り返し | 拡張 |
| {m,} | 直前の文字の、m回以上の繰り返し | 拡張 |
| () | グループ化 | 拡張 |
| `|` | 複数の正規表現をOR条件で指定 | 拡張 |

```bash
# hoge.txt から、fuga という単語の2回以上の繰り返しを探す
$ grep -E '(fuga){2,}' hoge.txt

# hoge.txt から、hoge fuga または hoge piyo を探す
$ grep -E 'hoge (fuga|piyo)' hoge.txt
```